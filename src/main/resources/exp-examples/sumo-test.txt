ea.experiment(
  runs = (randomGenerator = (seed = [1:1:1]) * [m.defaultRG()]) * [
    ea.run(
      solver = ea.s.ga(
        representation = ea.r.doubleString();
        mapper = er.m.ndsToFixedBodyCentralizedVSR(
          body = s.a.vsr.gridBody(
            sensorizingFunction = s.a.vsr.sf.directional(
              headSensors = [s.s.sin(f = 0); s.s.d(a = -15; r = 5)];
              nSensors = [s.s.ar(); s.s.v(a = 0); s.s.v(a = 90)];
              sSensors = [s.s.d(a = -90)]
            );
            shape = s.a.vsr.s.biped(w = 4; h = 3)
          );
          of = ea.m.noisedNds(of = ea.m.steppedNds(of = ea.m.dsToNpnds(npnds = ds.num.mlp()); stepT = 0.2))

        );
        nEval = 100;
        nPop = 10
      );
      problem = ea.p.simTo(
        simulation = s.task.trainingSumo(duration = 10; terrain = s.t.sumoArena());
        f = s.f.outcome.faXVelocity();
        type = maximize
      )
    )
  ];
  listeners = [
    ea.l.onRunDone(
        of = ea.a.lastBest();
        preprocessor = ea.f.toVideo(
            of = ea.f.solution();
            video = sim.taskVideoBuilder(
                task = s.task.trainingSumo(duration = 10; terrain = s.t.sumoArena());
                drawer = sim.drawer(framer = sim.staticFramer(minX = 10.0; maxX = 34.0; minY = 0.0; maxY = 15.0))
            );
            w = 600;
            h = 500;
            encoder = jcodec
        );
        consumers = [ea.c.saver(path = "video-{run.index}")]
    )
  ]
)